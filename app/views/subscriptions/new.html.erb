<section class="plans">
  <div class="plans__wrap">
    <h1 class="plans__title">
      Choose your subscription
      <span class="plans__subtitle">so you can contact other Quouch members</span>
    </h1>



    <div class="plans__content">
      <h2>Choose one of our payment plans depending on your situation</h2>
      <div class="plans__lists">
        <ul class="plans__list">
          <% @supporter.each do |plan| %>
          <li class="plans__list-item">
            <h3><%= plan.name %></h3>
            <ul class="plans__details">
              <li>
                <%= plan.description %>
              </li>
              <li>
                <%= plan.interval %>ly
              </li>
              <li class="plans__price">
                <%= humanized_money_with_symbol plan.price_cents %>
              </li>
            </ul>
          </li>
          <% end %>
        </ul>

        <ul class="plans__list">
          <% @member.each do |plan| %>
          <li class="plans__list-item">
            <h3><%= plan.name %></h3>
            <ul class="plans__details">
              <li>
                <%= plan.description %>
              </li>
              <li>
                <%= plan.interval %>ly
              </li>
              <li class="plans__price">
                <%= humanized_money_with_symbol plan.price_cents %>
              </li>
            </ul>
          </li>
          <% end %>
        </ul>

        <ul class="plans__list">
          <% @community.each do |plan| %>
          <li class="plans__list-item">
            <h3><%= plan.name %></h3>
            <ul class="plans__details">
              <li>
                <%= plan.description %>
              </li>
              <li>
                <%= plan.interval %>ly
              </li>
              <li class="plans__price">
                <%= humanized_money_with_symbol plan.price_cents %>
              </li>
            </ul>
          </li>
          <% end %>
        </ul>
      </div>
    </div>

    <button id="pay">Pay now</button>

    <script src="https://js.stripe.com/v3/"></script>
    <script>
      const paymentButton = document.getElementById('pay');
      paymentButton.addEventListener('click', () => {
        const stripe = Stripe('<%= ENV['STRIPE_PUBLISHABLE_KEY'] %>');
        stripe.redirectToCheckout({
          sessionId: '<#%= @payment.checkout_session_id %>'
        });
      });
    </script>

  </div>
</section>
