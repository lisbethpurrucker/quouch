import e from"./client.js";import t from"./client/default.js";import"./util/normalizeHeaderName.js";import r from"./util/responsePromise.js";import n from"./util/mixin.js";var i={};var o,s,u,l;o=t;s=n;u=r;l=e;function defaultInitHandler(e){return e}function defaultRequestHandler(e){return e}function defaultResponseHandler(e){return e}function ComplexRequest(e){if(!(this instanceof ComplexRequest))return new ComplexRequest(e);s(this,e)}function interceptor(e){var t,r,n,i;e=e||{};t=e.init||defaultInitHandler;r=e.request||defaultRequestHandler;n=e.success||e.response||defaultResponseHandler;i=e.error||function(){return Promise.resolve((e.response||defaultResponseHandler).apply(this,arguments)).then(Promise.reject.bind(Promise))};return function(s,a){"object"===typeof s&&(a=s);"function"!==typeof s&&(s=e.client||o);a=t(a||{});function interceptedClient(e){var t,o;t={};o={arguments:Array.prototype.slice.call(arguments),client:interceptedClient};e="string"===typeof e?{path:e}:e||{};e.originator=e.originator||interceptedClient;return u(r.call(t,e,a,o),(function(e){var r,u,l;l=s;if(e instanceof ComplexRequest){u=e.abort;l=e.client||l;r=e.response;e=e.request}r=r||Promise.resolve(e).then((function(e){return Promise.resolve(l(e)).then((function(e){return n.call(t,e,a,o)}),(function(e){return i.call(t,e,a,o)}))}));return u?Promise.race([r,u]):r}),(function(t){return Promise.reject({request:e,error:t})}))}return l(interceptedClient,s)}}interceptor.ComplexRequest=ComplexRequest;i=interceptor;var a=i;export default a;

